# GIF Maker Bot

Telegram бот на Golang для конвертации видео в GIF файлы.

## Возможности

- Принимает видео файлы длительностью до 20 секунд
- Конвертирует видео в GIF с настраиваемым качеством
- Одновременная обработка до 3 файлов
- Динамически обновляемые сообщения о статусе очереди
- Автоматическая очистка временных файлов

## Требования

- Go 1.21 или выше
- FFmpeg (включая ffprobe)

## Установка FFmpeg

### Windows

1. **Способ 1: Через Chocolatey (рекомендуется)**
   ```powershell
   choco install ffmpeg
   ```

2. **Способ 2: Ручная установка**
   - Скачайте FFmpeg с официального сайта: https://ffmpeg.org/download.html
   - Выберите версию для Windows (например, "Windows builds from gyan.dev")
   - Распакуйте архив в папку (например, `C:\ffmpeg`)
   - Добавьте путь к `bin` в переменную окружения PATH:
     - Откройте "Система" → "Дополнительные параметры системы" → "Переменные среды"
     - В "Системные переменные" найдите `Path` и нажмите "Изменить"
     - Добавьте путь к папке `bin` (например, `C:\ffmpeg\bin`)
     - Нажмите "ОК" во всех окнах
   - Перезапустите терминал/PowerShell

3. **Проверка установки**
   ```powershell
   ffmpeg -version
   ffprobe -version
   ```

### Linux Ubuntu/Debian

1. **Обновление списка пакетов**
   ```bash
   sudo apt update
   ```

2. **Установка FFmpeg**
   ```bash
   sudo apt install ffmpeg
   ```

3. **Проверка установки**
   ```bash
   ffmpeg -version
   ffprobe -version
   ```

## Установка и запуск

1. **Клонируйте репозиторий или скачайте файлы проекта**

2. **Установите зависимости**
   ```bash
   go mod download
   ```

3. **Настройте конфигурацию**
   - Откройте файл `config.yaml`
   - Укажите токен вашего Telegram бота:
     ```yaml
     bot:
       token: "YOUR_BOT_TOKEN_HERE"
     ```
   - При необходимости настройте параметры качества GIF:
     ```yaml
     gif:
       quality: "medium"  # low, medium, high
       fps: 10            # кадров в секунду
       width: 480         # ширина (0 = авто, сохраняет пропорции)
       colors: 256        # количество цветов (2-256)
     ```

4. **Получите токен бота**
   - Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
   - Отправьте команду `/newbot` и следуйте инструкциям
   - Скопируйте полученный токен в `config.yaml`

5. **Запустите бота**
   ```bash
   go run main.go
   ```

   Или скомпилируйте и запустите:
   ```bash
   go build -o gifmaker-bot
   ./gifmaker-bot  # Linux/Mac
   # или
   gifmaker-bot.exe  # Windows
   ```

## Конфигурация

Файл `config.yaml` содержит следующие настройки:

- `bot.token` - токен Telegram бота (обязательно)
- `gif.quality` - качество GIF (low, medium, high) - пока не используется, можно настроить через другие параметры
- `gif.fps` - количество кадров в секунду (рекомендуется 10-15)
- `gif.width` - ширина выходного GIF в пикселях (0 = автоматически, сохраняет пропорции)
- `gif.colors` - количество цветов в палитре (меньше = меньший размер файла, но хуже качество)
- `processing.max_concurrent` - максимальное количество одновременных обработок (по умолчанию 3)
- `processing.max_video_duration` - максимальная длительность видео в секундах (по умолчанию 20)

## Использование

1. Найдите вашего бота в Telegram
2. Отправьте команду `/start`
3. Отправьте видео файл (до 20 секунд)
4. Дождитесь обработки - бот отправит вам готовый GIF

## Особенности работы

- Бот обрабатывает до 3 видео одновременно
- Если очередь заполнена, вы получите сообщение с количеством файлов перед вами
- Сообщение о статусе очереди обновляется каждые 2 секунды
- Все временные файлы автоматически удаляются после обработки

## Решение проблем

### Ошибка "FFmpeg не найден"
- Убедитесь, что FFmpeg установлен и доступен в PATH
- Перезапустите терминал после установки FFmpeg
- Проверьте установку командой `ffmpeg -version`

### Ошибка при конвертации
- Убедитесь, что видео не длиннее 20 секунд
- Попробуйте видео с меньшим разрешением
- Проверьте, что видео файл не поврежден

### GIF файл слишком большой
- Уменьшите параметр `fps` в конфиге
- Уменьшите параметр `width` в конфиге
- Уменьшите параметр `colors` в конфиге
- Используйте более короткое видео

## Лицензия

MIT

